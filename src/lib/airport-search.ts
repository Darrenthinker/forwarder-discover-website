// å…¨çƒæœºåœºæœç´¢åŠŸèƒ½æ¨¡å—
import { oceaniaAirports } from './airport-codes-oceania';
import { asiaAirports } from './airport-codes-asia';
import { northAmericaAirports } from './airport-codes-north-america';
import { southAmericaAirports } from './airport-codes-south-america';
import { europeAirports } from './airport-codes-europe';
import { africaAirports } from './airport-codes-africa';
import { usaAirportsEnhanced } from './airport-codes-usa-enhanced';
import { chinaAirportsEnhanced } from './airport-codes-china-enhanced';
import { ukAirportsEnhanced } from './airport-codes-uk-enhanced';
import { germanyAirportsEnhanced } from './airport-codes-germany-enhanced';
import { canadaAirportsEnhanced } from './airport-codes-canada-enhanced';
import { mexicoAirportsEnhanced } from './airport-codes-mexico-enhanced';
import { franceAirportsEnhanced } from './airport-codes-france-enhanced';
import { italyAirportsEnhanced } from './airport-codes-italy-enhanced';
import { spainAirportsEnhanced } from './airport-codes-spain-enhanced';
import { japanAirportsEnhanced } from './airport-codes-japan-enhanced';
import { koreaAirportsEnhanced } from './airport-codes-korea-enhanced';
import { singaporeAirportsEnhanced } from './airport-codes-singapore-enhanced';
import { thailandAirportsEnhanced } from './airport-codes-thailand-enhanced';
import { malaysiaAirportsEnhanced } from './airport-codes-malaysia-enhanced';
import { indonesiaAirportsEnhanced } from './airport-codes-indonesia-enhanced';
import { uaeAirportsEnhanced } from './airport-codes-uae-enhanced';
import { indiaAirportsEnhanced } from './airport-codes-india-enhanced';
import { australiaAirportsEnhanced } from './airport-codes-australia-enhanced';
import { newZealandAirportsEnhanced } from './airport-codes-newzealand-enhanced';
import { southAfricaEnhancedAirports } from './airport-codes-southafrica-enhanced';
import { brazilEnhancedAirports } from './airport-codes-brazil-enhanced';
import { egyptEnhancedAirports } from './airport-codes-egypt-enhanced';
import { argentinaEnhancedAirports } from './airport-codes-argentina-enhanced';
import { russiaEnhancedAirports } from './airport-codes-russia-enhanced';
import { turkeyEnhancedAirports } from './airport-codes-turkey-enhanced';
import { netherlandsEnhancedAirports } from './airport-codes-netherlands-enhanced';
import { switzerlandEnhancedAirports } from './airport-codes-switzerland-enhanced';
import { austriaEnhancedAirports } from './airport-codes-austria-enhanced';
import { belgiumEnhancedAirports } from './airport-codes-belgium-enhanced';
import { denmarkEnhancedAirports } from './airport-codes-denmark-enhanced';
import { swedenEnhancedAirports } from './airport-codes-sweden-enhanced';
import { norwayEnhancedAirports } from './airport-codes-norway-enhanced';
import { finlandEnhancedAirports } from './airport-codes-finland-enhanced';
import { czechEnhancedAirports } from './airport-codes-czech-enhanced';
import { polandEnhancedAirports } from './airport-codes-poland-enhanced';
import { slovakiaEnhancedAirports } from './airport-codes-slovakia-enhanced';
import { hungaryEnhancedAirports } from './airport-codes-hungary-enhanced';
import { estoniaEnhancedAirports } from './airport-codes-estonia-enhanced';
import { latviaEnhancedAirports } from './airport-codes-latvia-enhanced';
import { lithuaniaEnhancedAirports } from './airport-codes-lithuania-enhanced';
import { croatiaEnhancedAirports } from './airport-codes-croatia-enhanced';
import { romaniaEnhancedAirports } from './airport-codes-romania-enhanced';
import { greeceEnhancedAirports } from './airport-codes-greece-enhanced';
import { serbiaEnhancedAirports } from './airport-codes-serbia-enhanced';
import { bulgariaEnhancedAirports } from './airport-codes-bulgaria-enhanced';
import { sloveniaEnhancedAirports } from './airport-codes-slovenia-enhanced';
import { bosniaEnhancedAirports } from './airport-codes-bosnia-enhanced';
import { macedoniaEnhancedAirports } from './airport-codes-macedonia-enhanced';
import { montenegroEnhancedAirports } from './airport-codes-montenegro-enhanced';
import { albaniaEnhancedAirports } from './airport-codes-albania-enhanced';
import { kosovoEnhancedAirports } from './airport-codes-kosovo-enhanced';
import { irelandEnhancedAirports } from './airport-codes-ireland-enhanced';
import { scotlandEnhancedAirports } from './airport-codes-scotland-enhanced';
import { italySouthEnhancedAirports } from './airport-codes-italy-south-enhanced';
import { franceSouthEnhancedAirports } from './airport-codes-france-south-enhanced';
import { spainBalearicEnhancedAirports } from './airport-codes-spain-balearic-enhanced';
import { greeceAegeanEnhancedAirports } from './airport-codes-greece-aegean-enhanced';
import { arcticNetworkEnhancedAirports } from './airport-codes-arctic-network-enhanced';
import { russiaSiberiaEnhancedAirports } from './airport-codes-russia-siberia-enhanced';
import { centralAsiaEnhancedAirports } from './airport-codes-central-asia-enhanced';
import { southAsiaEnhancedAirports } from './airport-codes-south-asia-enhanced';
import { southeastAsiaEnhancedAirports } from './airport-codes-southeast-asia-enhanced';
import { northAmericaArcticEnhancedAirports } from './airport-codes-north-america-arctic-enhanced';
import { eastAfricaEnhancedAirports } from './airport-codes-east-africa-enhanced';
import { southAmericaAndesEnhancedAirports } from './airport-codes-south-america-andes-enhanced';
import { westAsiaMiddleEastEnhancedAirports } from './airport-codes-west-asia-middle-east-enhanced';
import { westAfricaEnhancedAirports } from './airport-codes-west-africa-enhanced';
import { pacificIslandsEnhancedAirports } from './airport-codes-pacific-islands-enhanced';
import { northAfricaEnhancedAirports } from './airport-codes-north-africa-enhanced';
import { caucasusEnhancedAirports } from './airport-codes-caucasus-enhanced';
import { caribbeanIslandsEnhancedAirports } from './airport-codes-caribbean-islands-enhanced';
import { subSaharanAfricaEnhancedAirports } from './airport-codes-sub-saharan-africa-enhanced';
import { southAmericaOtherEnhancedAirports } from './airport-codes-south-america-other-enhanced';
import { asiaOtherEnhancedAirports } from './airport-codes-asia-other-enhanced';
import { europeOtherEnhancedAirports } from './airport-codes-europe-other-enhanced';
import { oceaniaOtherEnhancedAirports } from './airport-codes-oceania-other-enhanced';
import { centralAfricaEnhancedAirports } from './airport-codes-central-africa-enhanced';
import { southAmericaOverseasEnhancedAirports } from './airport-codes-south-america-overseas-enhanced';
import { antarcticaResearchEnhancedAirports } from './airport-codes-antarctica-research-enhanced';
import { timorLesteEnhancedAirports } from './airport-codes-timor-leste-enhanced';
import { nigerEnhancedAirports } from './airport-codes-niger-enhanced';
import { getCityPriority, extractCityName } from './city-priority';
import { formatCountryDisplay, getCountryInfoByCode, isCountryCode, searchCountries } from './country-codes';

// é‡æ–°å¯¼å‡ºå›½å®¶ä»£ç ç›¸å…³å‡½æ•°ï¼Œæ–¹ä¾¿å¤–éƒ¨ä½¿ç”¨
export { getCountryInfoByCode, isCountryCode, searchCountries } from './country-codes';
import { findStandardCountryName, shouldExcludeCountry, shouldExcludeAirportByName } from './country-aliases';
import { completeCountriesDatabase, CountryInfo, searchCompleteCountries } from './complete-countries';

// ğŸš€ æ–°å¢ï¼šæœç´¢æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿ
const searchCache = new Map<string, AirportSearchResult[]>();
const CACHE_SIZE_LIMIT = 100; // é™åˆ¶ç¼“å­˜å¤§å°é˜²æ­¢å†…å­˜æ³„æ¼

// ğŸš€ æ–°å¢ï¼šé¢„å¤„ç†æœç´¢ç´¢å¼•
interface SearchIndex {
  codeIndex: Map<string, AirportSearchResult[]>;
  nameIndex: Map<string, AirportSearchResult[]>;
  countryIndex: Map<string, AirportSearchResult[]>;
}

let searchIndex: SearchIndex | null = null;

// ğŸš€ æ„å»ºæœç´¢ç´¢å¼• - æé«˜æœç´¢æ€§èƒ½
function buildSearchIndex(): SearchIndex {
  if (searchIndex) return searchIndex;

  const codeIndex = new Map<string, AirportSearchResult[]>();
  const nameIndex = new Map<string, AirportSearchResult[]>();
  const countryIndex = new Map<string, AirportSearchResult[]>();

  Object.entries(globalAirports).forEach(([code, info]) => {
    const airport = formatAirportResult(code, info);

    // æŒ‰ä»£ç ç´¢å¼•
    const codeKey = code.toLowerCase();
    if (!codeIndex.has(codeKey)) codeIndex.set(codeKey, []);
    codeIndex.get(codeKey)!.push(airport);

    // æŒ‰åç§°ç´¢å¼•ï¼ˆåˆ†è¯ï¼‰
    const nameWords = [
      ...info.chinese.toLowerCase().split(''),
      ...info.english.toLowerCase().split(/\s+|[^a-zA-Z]/g).filter(w => w.length > 0)
    ];
    for (const word of nameWords) {
      if (word.length > 0) {
        if (!nameIndex.has(word)) nameIndex.set(word, []);
        nameIndex.get(word)!.push(airport);
      }
    }

    // æŒ‰å›½å®¶ç´¢å¼•
    const countryKey = info.country.toLowerCase();
    if (!countryIndex.has(countryKey)) countryIndex.set(countryKey, []);
    countryIndex.get(countryKey)!.push(airport);
  });

  searchIndex = { codeIndex, nameIndex, countryIndex };
  return searchIndex;
}

// ğŸš€ æ¸…ç†ç¼“å­˜ - é˜²æ­¢å†…å­˜æ³„æ¼
function cleanupCache() {
  if (searchCache.size > CACHE_SIZE_LIMIT) {
    const keysToDelete = Array.from(searchCache.keys()).slice(0, Math.floor(CACHE_SIZE_LIMIT / 2));
    for (const key of keysToDelete) {
      searchCache.delete(key);
    }
  }
}

// å…¨çƒæœºåœºæ•°æ®ç±»å‹
export type GlobalAirports = Record<string, AirportInfo>;

// åŸºç¡€æœºåœºä¿¡æ¯æ¥å£
export interface BaseAirportInfo {
  chinese: string;
  english: string;
  country: string;
}

// å¢å¼ºæœºåœºä¿¡æ¯æ¥å£
export interface EnhancedAirportInfo {
  type: 'international' | 'domestic' | 'regional';
  customs: boolean;
  priority: number;
}

// é€šç”¨æœºåœºä¿¡æ¯æ¥å£
export type AirportInfo = BaseAirportInfo & Partial<EnhancedAirportInfo>;

// æœç´¢ç»“æœæ¥å£
export interface AirportSearchResult extends Required<AirportInfo> {
  code: string;
  continent: string;
  countryWithCode: string;
  displayColor: string;
}

// æœºåœºç±»å‹é¢œè‰²é…ç½®
export const AIRPORT_COLORS = {
  international: '#10b981', // ç»¿è‰² - å›½é™…æœºåœº
  domestic: '#6b7280',      // ç°è‰² - å›½å†…æœºåœº
  regional: '#f59e0b'       // æ©™è‰² - åœ°åŒºæœºåœº
};

// æœºåœºç±»å‹æ˜¾ç¤ºæ–‡æœ¬
export const AIRPORT_TYPE_LABELS = {
  international: 'å›½é™…',
  domestic: 'å›½å†…',
  regional: 'åœ°åŒº'
};

// æ— æœºåœºå›½å®¶çš„é…ç½®ä¿¡æ¯
export interface NoAirportCountryInfo {
  chinese: string;
  english: string;
  code: string;
  reason: string; // æ— æœºåœºçš„åŸå› è¯´æ˜
  capital: string;
  continent: string;
  alternatives?: string[]; // æ¨èçš„æ›¿ä»£æœºåœº
}

// æ— æœºåœºå›½å®¶æ•°æ®åº“
export const NO_AIRPORT_COUNTRIES: NoAirportCountryInfo[] = [
  {
    chinese: 'å·´å‹’æ–¯å¦',
    english: 'Palestine',
    code: 'PS',
    reason: 'è”åˆå›½è§‚å¯Ÿå‘˜å›½ï¼Œç›®å‰æ— å›½é™…æœºåœº',
    capital: 'æ‹‰é©¬æ‹‰',
    continent: 'äºšæ´²',
    alternatives: ['å¯è€ƒè™‘ä½¿ç”¨çº¦æ—¦å®‰æ›¼æœºåœº(AMM)æˆ–ä»¥è‰²åˆ—ç‰¹æ‹‰ç»´å¤«æœºåœº(TLV)']
  },
  {
    chinese: 'æ¢µè’‚å†ˆ',
    english: 'Vatican City',
    code: 'VA',
    reason: 'ä¸–ç•Œæœ€å°å›½å®¶ï¼Œä½¿ç”¨ç½—é©¬æœºåœº',
    capital: 'æ¢µè’‚å†ˆ',
    continent: 'æ¬§æ´²',
    alternatives: ['ä½¿ç”¨æ„å¤§åˆ©ç½—é©¬è²ä¹Œç±³å¥‡è¯ºæœºåœº(FCO)']
  },
  {
    chinese: 'åœ£é©¬åŠ›è¯º',
    english: 'San Marino',
    code: 'SM',
    reason: 'å›½åœŸé¢ç§¯å°ï¼Œä½¿ç”¨é‚»å›½æœºåœº',
    capital: 'åœ£é©¬åŠ›è¯º',
    continent: 'æ¬§æ´²',
    alternatives: ['ä½¿ç”¨æ„å¤§åˆ©é‡Œç±³å°¼æœºåœºæˆ–åšæ´›å°¼äºšæœºåœº(BLQ)']
  },
  {
    chinese: 'æ‘©çº³å“¥',
    english: 'Monaco',
    code: 'MC',
    reason: 'å›½åœŸé¢ç§¯å°ï¼Œä½¿ç”¨é‚»å›½æœºåœº',
    capital: 'æ‘©çº³å“¥',
    continent: 'æ¬§æ´²',
    alternatives: ['ä½¿ç”¨æ³•å›½å°¼æ–¯æœºåœº(NCE)']
  },
  {
    chinese: 'å®‰é“å°”',
    english: 'Andorra',
    code: 'AD',
    reason: 'å±±åœ°å°å›½ï¼Œä½¿ç”¨é‚»å›½æœºåœº',
    capital: 'å®‰é“å°”åŸ',
    continent: 'æ¬§æ´²',
    alternatives: ['ä½¿ç”¨è¥¿ç­ç‰™å·´å¡ç½—é‚£æœºåœº(BCN)æˆ–æ³•å›½å›¾å¢å…¹æœºåœº(TLS)']
  },
  {
    chinese: 'åˆ—æ”¯æ•¦å£«ç™»',
    english: 'Liechtenstein',
    code: 'LI',
    reason: 'å›½åœŸé¢ç§¯å°ï¼Œä½¿ç”¨é‚»å›½æœºåœº',
    capital: 'ç“¦æœå…¹',
    continent: 'æ¬§æ´²',
    alternatives: ['ä½¿ç”¨ç‘å£«è‹é»ä¸–æœºåœº(ZUR)']
  }
];

// å¢å¼ºæœºåœºæ•°æ®æ¥å£
export interface EnhancedAirportData {
  iata: string;
  chinese: string;
  english: string;
  country: string;
  isInternational?: boolean;
  hasCustoms?: boolean;
  priority?: number;
}

// è½¬æ¢å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
function convertEnhancedToBasic(enhanced: EnhancedAirportData[]): Record<string, AirportInfo> {
  if (!Array.isArray(enhanced)) {
    return {}; // If not an array, return empty object to prevent crash
  }
  return enhanced.reduce((acc, airport) => {
    acc[airport.iata] = {
      chinese: airport.chinese,
      english: airport.english,
      country: airport.country,
      type: airport.isInternational ? 'international' : 'domestic',
      customs: airport.hasCustoms || false,
      priority: airport.priority || 0
    };
    return acc;
  }, {} as Record<string, AirportInfo>);
}

// è½¬æ¢å—éå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southAfricaBasicAirports = convertEnhancedToBasic(southAfricaEnhancedAirports);

// è½¬æ¢å·´è¥¿å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const brazilBasicAirports = convertEnhancedToBasic(brazilEnhancedAirports);

// è½¬æ¢åŸƒåŠå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const egyptBasicAirports = convertEnhancedToBasic(egyptEnhancedAirports);

// è½¬æ¢é˜¿æ ¹å»·å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const argentinaBasicAirports = convertEnhancedToBasic(argentinaEnhancedAirports);

// è½¬æ¢ä¿„ç½—æ–¯å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const russiaBasicAirports = convertEnhancedToBasic(russiaEnhancedAirports);

// è½¬æ¢åœŸè€³å…¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const turkeyBasicAirports = convertEnhancedToBasic(turkeyEnhancedAirports);

// è½¬æ¢è·å…°å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const netherlandsBasicAirports = convertEnhancedToBasic(netherlandsEnhancedAirports);

// è½¬æ¢ç‘å£«å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const switzerlandBasicAirports = convertEnhancedToBasic(switzerlandEnhancedAirports);

// è½¬æ¢å¥¥åœ°åˆ©å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const austriaBasicAirports = convertEnhancedToBasic(austriaEnhancedAirports);

// è½¬æ¢æ¯”åˆ©æ—¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const belgiumBasicAirports = convertEnhancedToBasic(belgiumEnhancedAirports);

// è½¬æ¢ä¸¹éº¦å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const denmarkBasicAirports = convertEnhancedToBasic(denmarkEnhancedAirports);

// è½¬æ¢ç‘å…¸å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const swedenBasicAirports = convertEnhancedToBasic(swedenEnhancedAirports);

// è½¬æ¢æŒªå¨å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const norwayBasicAirports = convertEnhancedToBasic(norwayEnhancedAirports);

// è½¬æ¢èŠ¬å…°å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const finlandBasicAirports = convertEnhancedToBasic(finlandEnhancedAirports);

// è½¬æ¢æ·å…‹å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const czechBasicAirports = convertEnhancedToBasic(czechEnhancedAirports);

// è½¬æ¢æ³¢å…°å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const polandBasicAirports = convertEnhancedToBasic(polandEnhancedAirports);

// è½¬æ¢æ–¯æ´›ä¼å…‹å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const slovakiaBasicAirports = convertEnhancedToBasic(slovakiaEnhancedAirports);

// è½¬æ¢åŒˆç‰™åˆ©å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const hungaryBasicAirports = convertEnhancedToBasic(hungaryEnhancedAirports);

// è½¬æ¢çˆ±æ²™å°¼äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const estoniaBasicAirports = convertEnhancedToBasic(estoniaEnhancedAirports);

// è½¬æ¢æ‹‰è„±ç»´äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const latviaBasicAirports = convertEnhancedToBasic(latviaEnhancedAirports);

// è½¬æ¢ç«‹é™¶å®›å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const lithuaniaBasicAirports = convertEnhancedToBasic(lithuaniaEnhancedAirports);

// è½¬æ¢å¡å°”ç»´äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const serbiaBasicAirports = convertEnhancedToBasic(serbiaEnhancedAirports);

// è½¬æ¢ä¿åŠ åˆ©äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const bulgariaBasicAirports = convertEnhancedToBasic(bulgariaEnhancedAirports);

// è½¬æ¢æ–¯æ´›æ–‡å°¼äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const sloveniaBasicAirports = convertEnhancedToBasic(sloveniaEnhancedAirports);

// è½¬æ¢æ³¢é»‘å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const bosniaBasicAirports = convertEnhancedToBasic(bosniaEnhancedAirports);

// è½¬æ¢åŒ—é©¬å…¶é¡¿å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const macedoniaBasicAirports = convertEnhancedToBasic(macedoniaEnhancedAirports);

// è½¬æ¢é»‘å±±å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const montenegroBasicAirports = convertEnhancedToBasic(montenegroEnhancedAirports);

// è½¬æ¢é˜¿å°”å·´å°¼äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const albaniaBasicAirports = convertEnhancedToBasic(albaniaEnhancedAirports);

// è½¬æ¢ç§‘ç´¢æ²ƒå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const kosovoBasicAirports = convertEnhancedToBasic(kosovoEnhancedAirports);

// è½¬æ¢çˆ±å°”å…°å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const irelandBasicAirports = convertEnhancedToBasic(irelandEnhancedAirports);

// è½¬æ¢è‹æ ¼å…°å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const scotlandBasicAirports = convertEnhancedToBasic(scotlandEnhancedAirports);

// è½¬æ¢æ„å¤§åˆ©å—éƒ¨å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const italySouthBasicAirports = convertEnhancedToBasic(italySouthEnhancedAirports);

// è½¬æ¢æ³•å›½å—éƒ¨å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const franceSouthBasicAirports = convertEnhancedToBasic(franceSouthEnhancedAirports);

// è½¬æ¢è¥¿ç­ç‰™å·´åˆ©é˜¿é‡Œç¾¤å²›å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const spainBalearicBasicAirports = convertEnhancedToBasic(spainBalearicEnhancedAirports);

// è½¬æ¢å¸Œè…Šçˆ±ç´æµ·ç¾¤å²›å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const greeceAegeanBasicAirports = convertEnhancedToBasic(greeceAegeanEnhancedAirports);

// è½¬æ¢åŒ—æåœˆèˆªç©ºç½‘ç»œå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const arcticNetworkBasicAirports = convertEnhancedToBasic(arcticNetworkEnhancedAirports);

// è½¬æ¢ä¿„ç½—æ–¯è¥¿ä¼¯åˆ©äºšæ‰©å±•å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const russiaSiberiaBasicAirports = convertEnhancedToBasic(russiaSiberiaEnhancedAirports);

// è½¬æ¢å…‹ç½—åœ°äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const croatiaBasicAirports = convertEnhancedToBasic(croatiaEnhancedAirports);

// è½¬æ¢ç½—é©¬å°¼äºšå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const romaniaBasicAirports = convertEnhancedToBasic(romaniaEnhancedAirports);

// è½¬æ¢å¸Œè…Šå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const greeceBasicAirports = convertEnhancedToBasic(greeceEnhancedAirports);

// è½¬æ¢ä¸­äºšäº”å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const centralAsiaBasicAirports = convertEnhancedToBasic(centralAsiaEnhancedAirports);

// è½¬æ¢å—äºšæ¬¡å¤§é™†å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southAsiaBasicAirports = convertEnhancedToBasic(southAsiaEnhancedAirports);

// è½¬æ¢ä¸œå—äºšå…­å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southeastAsiaBasicAirports = convertEnhancedToBasic(southeastAsiaEnhancedAirports);

// è½¬æ¢åŒ—ç¾é˜¿æ‹‰æ–¯åŠ +è‚²ç©ºå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const northAmericaArcticBasicAirports = convertEnhancedToBasic(northAmericaArcticEnhancedAirports);

// è½¬æ¢ä¸œéäº”å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const eastAfricaBasicAirports = convertEnhancedToBasic(eastAfricaEnhancedAirports);

// è½¬æ¢å—ç¾æ´²å®‰ç¬¬æ–¯å…­å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southAmericaAndesBasicAirports = convertEnhancedToBasic(southAmericaAndesEnhancedAirports);

// è½¬æ¢è¥¿äºšä¸­ä¸œå…­å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const westAsiaMiddleEastBasicAirports = convertEnhancedToBasic(westAsiaMiddleEastEnhancedAirports);

// è½¬æ¢éæ´²è¥¿éƒ¨äº”å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const westAfricaBasicAirports = convertEnhancedToBasic(westAfricaEnhancedAirports);

// è½¬æ¢å¤ªå¹³æ´‹å²›å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const pacificIslandsBasicAirports = convertEnhancedToBasic(pacificIslandsEnhancedAirports);

// è½¬æ¢åŒ—éä¸‰å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const northAfricaBasicAirports = convertEnhancedToBasic(northAfricaEnhancedAirports);

// è½¬æ¢é«˜åŠ ç´¢ä¸‰å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const caucasusBasicAirports = convertEnhancedToBasic(caucasusEnhancedAirports);

// è½¬æ¢åŠ å‹’æ¯”æµ·å²›å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const caribbeanIslandsBasicAirports = convertEnhancedToBasic(caribbeanIslandsEnhancedAirports);

// è½¬æ¢æ’’å“ˆæ‹‰ä»¥å—éæ´²å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const subSaharanAfricaBasicAirports = convertEnhancedToBasic(subSaharanAfricaEnhancedAirports);

// è½¬æ¢å—ç¾æ´²å…¶ä»–å›½å®¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southAmericaOtherBasicAirports = convertEnhancedToBasic(southAmericaOtherEnhancedAirports);

// è½¬æ¢äºšæ´²å…¶ä»–é‡è¦å›½å®¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const asiaOtherBasicAirports = convertEnhancedToBasic(asiaOtherEnhancedAirports);

// è½¬æ¢æ¬§æ´²å…¶ä»–é‡è¦å›½å®¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const europeOtherBasicAirports = convertEnhancedToBasic(europeOtherEnhancedAirports);

// è½¬æ¢å¤§æ´‹æ´²å…¶ä»–å²›å›½å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const oceaniaOtherBasicAirports = convertEnhancedToBasic(oceaniaOtherEnhancedAirports);

// è½¬æ¢ä¸­éå›½å®¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const centralAfricaBasicAirports = convertEnhancedToBasic(centralAfricaEnhancedAirports);

// è½¬æ¢å—ç¾æ´²æµ·å¤–é¢†åœŸå¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const southAmericaOverseasBasicAirports = convertEnhancedToBasic(southAmericaOverseasEnhancedAirports);

// è½¬æ¢å—ææ´²ç§‘ç ”ç«™å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const antarcticaResearchBasicAirports = convertEnhancedToBasic(antarcticaResearchEnhancedAirports);

// è½¬æ¢ä¸œå¸æ±¶å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const timorLesteBasicAirports = convertEnhancedToBasic(timorLesteEnhancedAirports);

// è½¬æ¢å°¼æ—¥å°”å¢å¼ºæ•°æ®ä¸ºåŸºç¡€æ ¼å¼
const nigerBasicAirports = convertEnhancedToBasic(nigerEnhancedAirports);

// åˆå¹¶æ‰€æœ‰æ´²é™…æœºåœºæ•°æ®
export const globalAirports: GlobalAirports = {
  ...oceaniaAirports,
  ...asiaAirports,
  ...northAmericaAirports,
  ...southAmericaAirports,
  ...europeAirports,
  ...africaAirports,
  // å¢å¼ºçš„ç¾å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...usaAirportsEnhanced,
  // å¢å¼ºçš„ä¸­å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...chinaAirportsEnhanced,
  // å¢å¼ºçš„è‹±å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...ukAirportsEnhanced,
  // å¢å¼ºçš„å¾·å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...germanyAirportsEnhanced,
  // å¢å¼ºçš„åŠ æ‹¿å¤§æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...canadaAirportsEnhanced,
  // å¢å¼ºçš„å¢¨è¥¿å“¥æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...mexicoAirportsEnhanced,
  // å¢å¼ºçš„æ³•å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...franceAirportsEnhanced,
  // å¢å¼ºçš„æ„å¤§åˆ©æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...italyAirportsEnhanced,
  // å¢å¼ºçš„è¥¿ç­ç‰™æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...spainAirportsEnhanced,
  // å¢å¼ºçš„æ—¥æœ¬æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...japanAirportsEnhanced,
  // å¢å¼ºçš„éŸ©å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...koreaAirportsEnhanced,
  // å¢å¼ºçš„æ–°åŠ å¡æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...singaporeAirportsEnhanced,
  // å¢å¼ºçš„æ³°å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...thailandAirportsEnhanced,
  // å¢å¼ºçš„é©¬æ¥è¥¿äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...malaysiaAirportsEnhanced,
  // å¢å¼ºçš„å°åº¦å°¼è¥¿äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...indonesiaAirportsEnhanced,
  // å¢å¼ºçš„é˜¿è”é…‹æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...uaeAirportsEnhanced,
  // å¢å¼ºçš„å°åº¦æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...indiaAirportsEnhanced,
  // å¢å¼ºçš„æ¾³å¤§åˆ©äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...australiaAirportsEnhanced,
  // å¢å¼ºçš„æ–°è¥¿å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...newZealandAirportsEnhanced,
  // å¢å¼ºçš„å—éæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southAfricaBasicAirports,
  // å¢å¼ºçš„å·´è¥¿æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...brazilBasicAirports,
  // å¢å¼ºçš„åŸƒåŠæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...egyptBasicAirports,
  // å¢å¼ºçš„é˜¿æ ¹å»·æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...argentinaBasicAirports,
  // å¢å¼ºçš„ä¿„ç½—æ–¯æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...russiaBasicAirports,
  // å¢å¼ºçš„åœŸè€³å…¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...turkeyBasicAirports,
  // å¢å¼ºçš„è·å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...netherlandsBasicAirports,
  // å¢å¼ºçš„ç‘å£«æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...switzerlandBasicAirports,
  // å¢å¼ºçš„å¥¥åœ°åˆ©æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...austriaBasicAirports,
  // å¢å¼ºçš„æ¯”åˆ©æ—¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...belgiumBasicAirports,
  // å¢å¼ºçš„ä¸¹éº¦æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...denmarkBasicAirports,
  // å¢å¼ºçš„ç‘å…¸æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...swedenBasicAirports,
  // å¢å¼ºçš„æŒªå¨æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...norwayBasicAirports,
  // å¢å¼ºçš„èŠ¬å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...finlandBasicAirports,
  // å¢å¼ºçš„æ·å…‹æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...czechBasicAirports,
  // å¢å¼ºçš„æ³¢å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...polandBasicAirports,
  // å¢å¼ºçš„æ–¯æ´›ä¼å…‹æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...slovakiaBasicAirports,
  // å¢å¼ºçš„åŒˆç‰™åˆ©æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...hungaryBasicAirports,
  // å¢å¼ºçš„çˆ±æ²™å°¼äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...estoniaBasicAirports,
  // å¢å¼ºçš„æ‹‰è„±ç»´äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...latviaBasicAirports,
  // å¢å¼ºçš„ç«‹é™¶å®›æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...lithuaniaBasicAirports,
  // å¢å¼ºçš„å…‹ç½—åœ°äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...croatiaBasicAirports,
  // å¢å¼ºçš„ç½—é©¬å°¼äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...romaniaBasicAirports,
  // å¢å¼ºçš„å¸Œè…Šæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...greeceBasicAirports,
  // å¢å¼ºçš„å¡å°”ç»´äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...serbiaBasicAirports,
  // å¢å¼ºçš„ä¿åŠ åˆ©äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...bulgariaBasicAirports,
  // å¢å¼ºçš„æ–¯æ´›æ–‡å°¼äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...sloveniaBasicAirports,
  // å¢å¼ºçš„æ³¢é»‘æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...bosniaBasicAirports,
  // å¢å¼ºçš„åŒ—é©¬å…¶é¡¿æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...macedoniaBasicAirports,
  // å¢å¼ºçš„é»‘å±±æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...montenegroBasicAirports,
  // å¢å¼ºçš„é˜¿å°”å·´å°¼äºšæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...albaniaBasicAirports,
  // å¢å¼ºçš„ç§‘ç´¢æ²ƒæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...kosovoBasicAirports,
  // å¢å¼ºçš„çˆ±å°”å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...irelandBasicAirports,
  // å¢å¼ºçš„è‹æ ¼å…°æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...scotlandBasicAirports,
  // å¢å¼ºçš„æ„å¤§åˆ©å—éƒ¨æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...italySouthBasicAirports,
  // å¢å¼ºçš„æ³•å›½å—éƒ¨æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...franceSouthBasicAirports,
  // å¢å¼ºçš„è¥¿ç­ç‰™å·´åˆ©é˜¿é‡Œç¾¤å²›æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...spainBalearicBasicAirports,
  // å¢å¼ºçš„å¸Œè…Šçˆ±ç´æµ·ç¾¤å²›æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...greeceAegeanBasicAirports,
  // å¢å¼ºçš„åŒ—æåœˆèˆªç©ºç½‘ç»œæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...arcticNetworkBasicAirports,
  // å¢å¼ºçš„ä¿„ç½—æ–¯è¥¿ä¼¯åˆ©äºšæ‰©å±•æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...russiaSiberiaBasicAirports,
  // å¢å¼ºçš„ä¸­äºšäº”å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...centralAsiaBasicAirports,
  // å¢å¼ºçš„å—äºšæ¬¡å¤§é™†æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southAsiaBasicAirports,
  // å¢å¼ºçš„ä¸œå—äºšå…­å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southeastAsiaBasicAirports,
  // å¢å¼ºçš„åŒ—ç¾é˜¿æ‹‰æ–¯åŠ +è‚²ç©ºæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...northAmericaArcticBasicAirports,
  // å¢å¼ºçš„ä¸œéäº”å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...eastAfricaBasicAirports,
  // å¢å¼ºçš„å—ç¾æ´²å®‰ç¬¬æ–¯å…­å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southAmericaAndesBasicAirports,
  // å¢å¼ºçš„è¥¿äºšä¸­ä¸œå…­å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...westAsiaMiddleEastBasicAirports,
  // å¢å¼ºçš„éæ´²è¥¿éƒ¨äº”å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...westAfricaBasicAirports,
  // å¢å¼ºçš„å¤ªå¹³æ´‹å²›å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...pacificIslandsBasicAirports,
  // å¢å¼ºçš„åŒ—éä¸‰å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...northAfricaBasicAirports,
  // å¢å¼ºçš„é«˜åŠ ç´¢ä¸‰å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...caucasusBasicAirports,
  // å¢å¼ºçš„åŠ å‹’æ¯”æµ·å²›å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...caribbeanIslandsBasicAirports,
  // å¢å¼ºçš„æ’’å“ˆæ‹‰ä»¥å—éæ´²æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...subSaharanAfricaBasicAirports,
  // å¢å¼ºçš„å—ç¾æ´²å…¶ä»–å›½å®¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southAmericaOtherBasicAirports,
  // å¢å¼ºçš„äºšæ´²å…¶ä»–é‡è¦å›½å®¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...asiaOtherBasicAirports,
  // å¢å¼ºçš„æ¬§æ´²å…¶ä»–é‡è¦å›½å®¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...europeOtherBasicAirports,
  // å¢å¼ºçš„å¤§æ´‹æ´²å…¶ä»–å²›å›½æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...oceaniaOtherBasicAirports,
  // å¢å¼ºçš„ä¸­éå›½å®¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...centralAfricaBasicAirports,
  // å¢å¼ºçš„å—ç¾æ´²æµ·å¤–é¢†åœŸæœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...southAmericaOverseasBasicAirports,
  // å¢å¼ºçš„å—ææ´²ç§‘ç ”ç«™æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...antarcticaResearchBasicAirports,
  // å¢å¼ºçš„ä¸œå¸æ±¶æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...timorLesteBasicAirports,
  // å¢å¼ºçš„å°¼æ—¥å°”æœºåœºæ•°æ®è¦†ç›–åŸæœ‰æ•°æ®
  ...nigerBasicAirports
};

// è·å–æœºåœºæ‰€å±æ´²é™…
export function getAirportContinent(code: string): string {
  const airportInfo = globalAirports[code.toUpperCase()];

  // å¦‚æœæ•°æ®ä¸­æ²¡æœ‰ï¼Œå†è¿›è¡Œæ—§çš„é€»è¾‘åˆ¤æ–­ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
  // æœ€ä¼˜å…ˆæ£€æŸ¥å—ææ´²ç§‘ç ”ç«™ (ç‰¹æ®Šåœ°åŒºä¼˜å…ˆ)
  if (antarcticaResearchEnhancedAirports.some(a => a.iata === code)) return 'å—ææ´²';

  // ç„¶åæ£€æŸ¥åŸå§‹æ´²é™…æ•°æ® (åŸºç¡€æ•°æ®ä¼˜å…ˆ)
  if (oceaniaAirports[code]) return 'å¤§æ´‹æ´²';
  if (asiaAirports[code]) return 'äºšæ´²';
  if (northAmericaAirports[code]) return 'åŒ—ç¾';
  if (southAmericaAirports[code]) return 'å—ç¾';
  if (europeAirports[code]) return 'æ¬§æ´²';
  if (africaAirports[code]) return 'éæ´²';

  // æ£€æŸ¥å„å›½å¢å¼ºæœºåœºæ•°æ® (æŒ‰æ´²é™…åˆ†ç»„)

  // åŒ—ç¾æ´²
  if (usaAirportsEnhanced[code]) return 'åŒ—ç¾';
  if (canadaAirportsEnhanced[code]) return 'åŒ—ç¾';
  if (mexicoAirportsEnhanced[code]) return 'åŒ—ç¾';
  if (northAmericaArcticEnhancedAirports.some(a => a.iata === code)) return 'åŒ—ç¾';
  if (caribbeanIslandsEnhancedAirports.some(a => a.iata === code)) return 'åŒ—ç¾';

  // å—ç¾æ´²
  if (brazilEnhancedAirports.some(a => a.iata === code)) return 'å—ç¾';
  if (argentinaEnhancedAirports.some(a => a.iata === code)) return 'å—ç¾';
  if (southAmericaAndesEnhancedAirports.some(a => a.iata === code)) return 'å—ç¾';
  if (southAmericaOtherEnhancedAirports.some(a => a.iata === code)) return 'å—ç¾';
  if (southAmericaOverseasEnhancedAirports.some(a => a.iata === code)) return 'å—ç¾';

  // æ¬§æ´²
  if (ukAirportsEnhanced[code]) return 'æ¬§æ´²';
  if (germanyAirportsEnhanced[code]) return 'æ¬§æ´²';
  if (franceAirportsEnhanced[code]) return 'æ¬§æ´²';
  if (italyAirportsEnhanced[code]) return 'æ¬§æ´²';
  if (spainAirportsEnhanced[code]) return 'æ¬§æ´²';
  if (russiaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (turkeyEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (netherlandsEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (switzerlandEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (austriaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (belgiumEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (denmarkEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (swedenEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (norwayEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (finlandEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (czechEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (polandEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (slovakiaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (hungaryEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (estoniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (latviaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (lithuaniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (croatiaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (romaniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (greeceEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (serbiaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (bulgariaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (sloveniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (bosniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (macedoniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (montenegroEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (albaniaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (kosovoEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (irelandEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (scotlandEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (italySouthEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (franceSouthEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (spainBalearicEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (greeceAegeanEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (arcticNetworkEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (russiaSiberiaEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';
  if (europeOtherEnhancedAirports.some(a => a.iata === code)) return 'æ¬§æ´²';

  // äºšæ´²
  if (chinaAirportsEnhanced[code]) return 'äºšæ´²';
  if (japanAirportsEnhanced[code]) return 'äºšæ´²';
  if (koreaAirportsEnhanced[code]) return 'äºšæ´²';
  if (singaporeAirportsEnhanced[code]) return 'äºšæ´²';
  if (thailandAirportsEnhanced[code]) return 'äºšæ´²';
  if (malaysiaAirportsEnhanced[code]) return 'äºšæ´²';
  if (indonesiaAirportsEnhanced[code]) return 'äºšæ´²';
  if (uaeAirportsEnhanced[code]) return 'äºšæ´²';
  if (indiaAirportsEnhanced[code]) return 'äºšæ´²';
  if (centralAsiaEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (southAsiaEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (southeastAsiaEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (timorLesteEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (westAsiaMiddleEastEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (caucasusEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';
  if (asiaOtherEnhancedAirports.some(a => a.iata === code)) return 'äºšæ´²';

  // éæ´²
  if (southAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (egyptEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (eastAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (westAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (northAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (subSaharanAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (centralAfricaEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';
  if (nigerEnhancedAirports.some(a => a.iata === code)) return 'éæ´²';

  // å¤§æ´‹æ´²
  if (australiaAirportsEnhanced[code]) return 'å¤§æ´‹æ´²';
  if (newZealandAirportsEnhanced[code]) return 'å¤§æ´‹æ´²';
  if (pacificIslandsEnhancedAirports.some(a => a.iata === code)) return 'å¤§æ´‹æ´²';
  if (oceaniaOtherEnhancedAirports.some(a => a.iata === code)) return 'å¤§æ´‹æ´²';

  return 'æœªçŸ¥';
}

// è·å–å›½å®¶ä»£ç 
function getCountryCodeByName(countryName: string): string {
  const country = completeCountriesDatabase.find((c: CountryInfo) => c.chinese === countryName);
  return country ? country.code : '';
}

// è·å–æœºåœºç±»å‹å¯¹åº”çš„æ˜¾ç¤ºé¢œè‰²
function getDisplayColorByType(type: 'international' | 'domestic' | 'regional'): string {
  const colors = {
    'international': '#3b82f6', // è“è‰²
    'domestic': '#10b981',      // ç»¿è‰²
    'regional': '#6b7280'       // ç°è‰²
  };
  return colors[type];
}

// æ ¼å¼åŒ–æœºåœºæœç´¢ç»“æœ
function formatAirportResult(code: string, info: AirportInfo): AirportSearchResult {
  const type = info.type || 'domestic';
  const customs = info.customs || false;
  const priority = info.priority !== undefined ? info.priority : 50; // æ˜ç¡®æ£€æŸ¥undefinedï¼Œç»™æ²¡æœ‰priorityçš„æœºåœºé»˜è®¤å€¼50

  return {
    code,
    chinese: info.chinese,
    english: info.english,
    country: info.country,
    type,
    customs,
    priority,
    continent: getAirportContinent(code),
    countryWithCode: `${info.country} ${getCountryCodeByName(info.country)}`,
    displayColor: getDisplayColorByType(type)
  };
}

/**
 * æ ¹æ®IATAä»£ç ç²¾ç¡®æŸ¥æ‰¾æœºåœº
 */
export function findAirportByCode(code: string): AirportSearchResult | null {
  const upperCode = code.toUpperCase();
  const airportInfo = globalAirports[upperCode];

  if (airportInfo) {
    return formatAirportResult(upperCode, airportInfo);
  }

  return null;
}

/**
 * æ ¹æ®å›½å®¶æŸ¥æ‰¾æœºåœºï¼ˆæ”¯æŒæ™ºèƒ½æ’åºå’Œæ•°é‡é™åˆ¶ï¼‰
 */
export function findAirportsByCountry(
  country: string,
  limit?: number,
  exactMatch = true
): AirportSearchResult[] {
  const results: AirportSearchResult[] = [];

  Object.entries(globalAirports).forEach(([code, info]) => {
    // å®‰å…¨æ£€æŸ¥ï¼Œç¡®ä¿ info å’Œ info.country å­˜åœ¨
    if (info && info.country) {
    // æ ¹æ®exactMatchå‚æ•°å†³å®šæ˜¯ç²¾ç¡®åŒ¹é…è¿˜æ˜¯æ¨¡ç³ŠåŒ¹é…
    const match = exactMatch
      ? info.country.toLowerCase() === country.toLowerCase()
      : info.country.toLowerCase().includes(country.toLowerCase());

    if (match) {
      results.push(formatAirportResult(code, info));
      }
    }
  });

  // ğŸ¯ æ™ºèƒ½æ’åºï¼šå›½é™…æœºåœºç±»å‹ > æœºåœºä¼˜å…ˆçº§ > åŸå¸‚é‡è¦æ€§ > å­—æ¯é¡ºåº
  results.sort((a, b) => {
    // ğŸ”¥ é¦–å…ˆæŒ‰æœºåœºç±»å‹æ’åº (å›½é™…æœºåœºç»å¯¹ä¼˜å…ˆ)
    const getAirportTypeScore = (airport: AirportSearchResult): number => {
      // å¦‚æœæœ‰æ˜ç¡®ç±»å‹å®šä¹‰
      if (airport.type === 'international') return 1000;
      if (airport.type === 'regional') return 500;
      if (airport.type === 'domestic') return 100;

      // å¦‚æœæ²¡æœ‰ç±»å‹å®šä¹‰ï¼Œè¿›è¡Œæ™ºèƒ½åˆ¤æ–­
      const code = airport.code;
      const chineseName = airport.chinese.toLowerCase();
      const englishName = airport.english.toLowerCase();

      // å…¨çƒçŸ¥åå›½é™…æœºåœºä»£ç åˆ¤æ–­ï¼ˆä¼˜å…ˆçº§éå¸¸é«˜ï¼‰
      const knownInternationalCodes = [
        // å°æ¹¾ä¸»è¦å›½é™…æœºåœº
        'TPE', 'KHH', 'RMQ', 'TXG', 'TTT',
        // ä¸­å›½ä¸»è¦å›½é™…æœºåœº
        'PEK', 'PVG', 'CAN', 'CTU', 'PKX', 'SZX', 'CGO', 'TSN', 'URC', 'NKG',
        'HGH', 'WUH', 'XMN', 'DLC', 'SHE', 'HRB', 'CKG', 'KMG', 'TAO', 'HAK',
        'BJS', 'SHA', // åŒ—äº¬ã€ä¸Šæµ·åŸå¸‚ä»£ç 
        // æ¸¯æ¾³åœ°åŒº
        'HKG', 'MFM',
        // å°åº¦ä¸»è¦å›½é™…æœºåœº
        'DEL', 'BOM', 'BLR', 'MAA', 'HYD', 'CCU', 'AMD', 'PNQ', 'GOI', 'COK', 'TRV', 'JAI', 'LKO', 'NAG',
        // å…¶ä»–çŸ¥åå›½é™…æœºåœºï¼ˆç§»é™¤è‹±å›½æœºåœºï¼Œè®©å®ƒä»¬ä½¿ç”¨æ˜ç¡®çš„typeå®šä¹‰ï¼‰
        'ICN', 'NRT', 'SIN', 'LAX', 'JFK', 'CDG', 'FRA', 'DXB'
      ];

      if (knownInternationalCodes.includes(code)) return 900;

      // æ ¹æ®åç§°åŒ…å«"å›½é™…"åˆ¤æ–­
      if (chineseName.includes('å›½é™…') || englishName.includes('international') || englishName.includes('intl')) {
        return 800;
      }

      // ä¸»è¦åŸå¸‚æœºåœºï¼ˆé€šå¸¸æ˜¯å›½é™…æœºåœºï¼‰
      const aCityName = extractCityName(airport.chinese);
      const cityPriority = getCityPriority(aCityName, airport.country);
      if (cityPriority <= 1) { // é¦–éƒ½æˆ–ä¸»è¦åŸå¸‚
        return 750;
      }

      return 200; // é»˜è®¤åˆ†æ•°
    };

    const typeScoreA = getAirportTypeScore(a);
    const typeScoreB = getAirportTypeScore(b);

    if (typeScoreA !== typeScoreB) {
      return typeScoreB - typeScoreA; // å›½é™…æœºåœºä¼˜å…ˆ
    }

    // ğŸš› å¯¹äºåŒç±»å‹æœºåœºï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº (æ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜) - è¿™æ˜¯æ ¸å¿ƒæ’åº
    const priorityA = a.priority; // ä¸ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¿æŒåŸå§‹å€¼
    const priorityB = b.priority;
    if (priorityA !== priorityB) {
      return priorityB - priorityA;
    }

    // ğŸ™ï¸ ç„¶åæŒ‰åŸå¸‚é‡è¦æ€§æ’åº (æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜)
    const aCityName = extractCityName(a.chinese);
    const bCityName = extractCityName(b.chinese);
    const aCityPriority = getCityPriority(aCityName, a.country);
    const bCityPriority = getCityPriority(bCityName, b.country);
    if (aCityPriority !== bCityPriority) {
      return aCityPriority - bCityPriority;
    }

    // ğŸ“ æœ€åæŒ‰æœºåœºä»£ç æ’åº
    return a.code.localeCompare(b.code);
  });

  // å¦‚æœæŒ‡å®šäº†é™åˆ¶ï¼Œåˆ™åº”ç”¨é™åˆ¶
  if (limit && limit > 0) {
    return results.slice(0, limit);
  }

  // å¦‚æœæ²¡æœ‰æŒ‡å®šé™åˆ¶ï¼Œä½¿ç”¨æ™ºèƒ½é™åˆ¶
  const stats = getCountryAirportStats(country);
  return results.slice(0, stats.recommendedDisplay);
}

/**
 * æ£€æŸ¥æ˜¯å¦ä¸ºç‰¹åˆ«è¡Œæ”¿åŒºæœç´¢å¹¶è¿”å›å¯¹åº”ç»“æœ
 */
function checkSpecialRegionSearch(query: string, limit: number): AirportSearchResult[] | null {
  const queryLower = query.toLowerCase().trim();

  // ç‰¹æ®Šè¡Œæ”¿åŒºæ˜ å°„ - ç›´æ¥æœç´¢æœºåœºåç§°è€Œä¸æ˜¯å›½å®¶
  const specialRegions: Record<string, { chinese: string; english: string; code: string; airports: string[] }> = {
    'hk': { chinese: 'é¦™æ¸¯', english: 'Hong Kong', code: 'HK', airports: ['HKG'] },
    'mo': { chinese: 'æ¾³é—¨', english: 'Macau', code: 'MO', airports: ['MFM'] },
    'tw': { chinese: 'å°æ¹¾', english: 'Taiwan', code: 'TW', airports: [] }, // å°æ¹¾æœºåœºé€šè¿‡å›½å®¶æœç´¢å¤„ç†
    'pr': { chinese: 'æ³¢å¤šé»å„', english: 'Puerto Rico', code: 'PR', airports: [] }
  };

  // æ£€æŸ¥æ˜¯å¦ä¸ºç‰¹æ®Šè¡Œæ”¿åŒºä»£ç æˆ–åç§°
  for (const [code, info] of Object.entries(specialRegions)) {
    // ç²¾ç¡®åŒ¹é…ä»£ç 
    if (code === queryLower) {
      // å¯¹äºé¦™æ¸¯å’Œæ¾³é—¨ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„æœºåœº
      if (info.airports.length > 0) {
        const results: AirportSearchResult[] = [];
        for (const airportCode of info.airports) {
          const airport = findAirportByCode(airportCode);
          if (airport) {
            results.push(airport);
          }
        }
        return results;
      } else {
        // å¯¹äºå…¶ä»–åœ°åŒºï¼Œä½¿ç”¨å›½å®¶æœç´¢
        return findAirportsByCountry(info.chinese, limit);
      }
    }
    
    // ä¸­æ–‡åç§°ç²¾ç¡®åŒ¹é…æˆ–åŒ…å«åŒ¹é…
    if (info.chinese === query || info.chinese.includes(query)) {
      // å¯¹äºé¦™æ¸¯å’Œæ¾³é—¨ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„æœºåœº
      if (info.airports.length > 0) {
        const results: AirportSearchResult[] = [];
        for (const airportCode of info.airports) {
          const airport = findAirportByCode(airportCode);
          if (airport) {
            results.push(airport);
          }
        }
        return results;
      } else {
        // å¯¹äºå…¶ä»–åœ°åŒºï¼Œä½¿ç”¨å›½å®¶æœç´¢
        return findAirportsByCountry(info.chinese, limit);
      }
    }
    
         // è‹±æ–‡åç§°åŒ¹é… - åªå¯¹é•¿æŸ¥è¯¢ï¼ˆ3å­—ç¬¦ä»¥ä¸Šï¼‰è¿›è¡Œéƒ¨åˆ†åŒ¹é…
     if (query.length >= 3 && info.english.toLowerCase().includes(queryLower)) {
       // å¯¹äºé¦™æ¸¯å’Œæ¾³é—¨ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„æœºåœº
       if (info.airports.length > 0) {
         const results: AirportSearchResult[] = [];
         for (const airportCode of info.airports) {
           const airport = findAirportByCode(airportCode);
           if (airport) {
             results.push(airport);
           }
         }
         return results;
       } else {
         // å¯¹äºå…¶ä»–åœ°åŒºï¼Œä½¿ç”¨å›½å®¶æœç´¢
         return findAirportsByCountry(info.chinese, limit);
       }
     }
   }

  return null;
}

/**
 * æ£€æŸ¥æ˜¯å¦ä¸ºæ— æœºåœºå›½å®¶æœç´¢å¹¶è¿”å›ç‰¹æ®Šç»“æœ
 */
function checkNoAirportCountrySearch(query: string): AirportSearchResult | null {
  const queryLower = query.toLowerCase().trim();

  // æ£€æŸ¥æ˜¯å¦åŒ¹é…æ— æœºåœºå›½å®¶
  for (const country of NO_AIRPORT_COUNTRIES) {
    const chineseMatch = country.chinese.toLowerCase() === queryLower;
    const englishMatch = country.english.toLowerCase() === queryLower;

    // æ£€æŸ¥å›½å®¶åˆ«å
    const standardCountryName = findStandardCountryName(query);
    const aliasMatch = standardCountryName === country.chinese;

    if (chineseMatch || englishMatch || aliasMatch) {
      // åˆ›å»ºç‰¹æ®Šçš„æœç´¢ç»“æœï¼Œæ˜¾ç¤ºæ— æœºåœºä¿¡æ¯
      return {
        code: 'NO-AIRPORT',
        chinese: `${country.chinese} - æ— å›½é™…æœºåœº`,
        english: `${country.english} - No International Airport`,
        country: country.chinese,
        type: 'domestic' as const,
        customs: false,
        priority: 0,
        continent: country.continent,
        countryWithCode: `${country.chinese} ${country.code}`,
        displayColor: '#ef4444' // çº¢è‰²è¡¨ç¤ºæ— æœºåœº
      };
    }
  }

  return null;
}

/**
 * æ ¹æ®ç‰¹å®šåœ°åŒºæœç´¢æœºåœºï¼ˆç”¨äºç‰¹åˆ«è¡Œæ”¿åŒºï¼‰
 */
function findAirportsByRegion(regionName: string, limit: number): AirportSearchResult[] {
  const results: AirportSearchResult[] = [];

  Object.entries(globalAirports).forEach(([code, info]) => {
    // æ£€æŸ¥æœºåœºåç§°æ˜¯å¦åŒ¹é…æŒ‡å®šåœ°åŒº
    if (info.chinese === regionName || info.chinese.includes(regionName)) {
      results.push(formatAirportResult(code, info));
    }
  });

  // ä½¿ç”¨ä¸å›½å®¶æœç´¢ç›¸åŒçš„æ’åºé€»è¾‘
  results.sort((a, b) => {
    const priorityA = a.priority || 50;
    const priorityB = b.priority || 50;
    if (priorityA !== priorityB) {
      return priorityB - priorityA; // ä¼˜å…ˆçº§é«˜çš„æ’å‰é¢
    }
    return a.code.localeCompare(b.code);
  });

  return limit > 0 ? results.slice(0, limit) : results;
}

// ğŸš€ æ„å»ºæœç´¢ç´¢å¼• - æé«˜æœç´¢æ€§èƒ½

/**
 * æ™ºèƒ½æœç´¢æœºåœºï¼ˆæ”¯æŒå¤šç§æœç´¢æ–¹å¼ï¼‰- æ€§èƒ½ä¼˜åŒ–ç‰ˆæœ¬
 */
export function searchAirports(query: string, limit: number = 10): AirportSearchResult[] {
  if (!query) return [];
  
  // æ£€æŸ¥æ˜¯å¦ä¸ºç‰¹æ®Šè¡Œæ”¿åŒºæœç´¢
  const specialRegionResults = checkSpecialRegionSearch(query, limit);
  if (specialRegionResults) {
    return specialRegionResults;
  }

  // æ£€æŸ¥æ˜¯å¦ä¸ºå›½å®¶ä»£ç æœç´¢
  const countryResults = searchByCountryCode(query, limit);
  if (countryResults && countryResults.length > 0) {
    return countryResults;
  }

  // ğŸŒ æ–°å¢ï¼šæ™ºèƒ½å›½å®¶åæœç´¢ - æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€ä»£ç æœç´¢
  const matchedCountries = searchCompleteCountries(query);
  if (matchedCountries.length > 0) {
    // ğŸ”§ ä¿®å¤ï¼šç›´æ¥æ¨¡æ‹Ÿå¸¸è§„æœç´¢é€»è¾‘ï¼Œè€Œä¸æ˜¯è°ƒç”¨findAirportsByCountry
    const countrySearchResults: AirportSearchResult[] = [];
    
    for (const [code, info] of Object.entries(globalAirports)) {
      if (shouldExcludeAirportByName(query, info.chinese, info.country) || shouldExcludeCountry(query, info.country)) {
        continue;
      }

      // æ£€æŸ¥æ˜¯å¦åŒ¹é…ä»»ä½•æ‰¾åˆ°çš„å›½å®¶
      const matchesCountry = matchedCountries.some(country => 
        info.country === country.chinese || 
        info.country.toLowerCase() === country.english.toLowerCase()
      );

      if (matchesCountry) {
        countrySearchResults.push(formatAirportResult(code, info));
      }
    }
    
    if (countrySearchResults.length > 0) {
      // ğŸ”§ ä½¿ç”¨å’Œå¸¸è§„æœç´¢ç›¸åŒçš„æ’åºé€»è¾‘
      return countrySearchResults
        .sort((a, b) => {
          // ä¼˜å…ˆçº§æ’åº
          if (a.priority !== b.priority) {
            return b.priority - a.priority;
          }
          // å›½é™…æœºåœºä¼˜å…ˆ
          if (a.type !== b.type) {
            return a.type === 'international' ? -1 : 1;
          }
          // æŒ‰ä»£ç å­—æ¯é¡ºåº
          return a.code.localeCompare(b.code);
        })
        .slice(0, limit); // ä¿æŒå’Œå¸¸è§„æœç´¢ç›¸åŒçš„limitè¡Œä¸º
    }
  }

  // å¸¸è§„æœç´¢é€»è¾‘
  const results: AirportSearchResult[] = [];
  const queryLower = query.toLowerCase().trim();

  for (const [code, info] of Object.entries(globalAirports)) {
    if (shouldExcludeAirportByName(query, info.chinese, info.country) || shouldExcludeCountry(query, info.country)) {
      continue;
    }

    // ç²¾ç¡®åŒ¹é…æœºåœºä»£ç 
    if (code.toLowerCase() === queryLower) {
      results.push(formatAirportResult(code, info));
      continue;
    }

    // ä¸­æ–‡åç§°åŒ¹é…
    if (info.chinese.includes(query)) {
      results.push(formatAirportResult(code, info));
      continue;
    }

    // å›½å®¶åç§°åŒ¹é…ï¼ˆä¿ç•™åŸæœ‰çš„ä¸­æ–‡å›½å®¶ååŒ¹é…ä½œä¸ºå¤‡é€‰ï¼‰
    if (info.country.includes(query)) {
      results.push(formatAirportResult(code, info));
      continue;
    }

    // è‹±æ–‡åç§°åŒ¹é… - å¯¹äºçŸ­æŸ¥è¯¢ï¼ˆ2å­—ç¬¦ä»¥ä¸‹ï¼‰é¿å…éƒ¨åˆ†åŒ¹é…
    if (query.length > 2 && info.english.toLowerCase().includes(queryLower)) {
      results.push(formatAirportResult(code, info));
      continue;
    }

    // å¯¹äºé•¿æŸ¥è¯¢ï¼ˆ3å­—ç¬¦ä»¥ä¸Šï¼‰ï¼Œå…è®¸è‹±æ–‡åç§°çš„å¼€å¤´åŒ¹é…
    if (query.length >= 3 && info.english.toLowerCase().startsWith(queryLower)) {
      results.push(formatAirportResult(code, info));
      continue;
    }
  }

  // æŒ‰ä¼˜å…ˆçº§å’Œç±»å‹æ’åº
  return results
    .sort((a, b) => {
      // ä¼˜å…ˆçº§æ’åº
      if (a.priority !== b.priority) {
        return b.priority - a.priority;
      }
      // å›½é™…æœºåœºä¼˜å…ˆ
      if (a.type !== b.type) {
        return a.type === 'international' ? -1 : 1;
      }
      // æŒ‰ä»£ç å­—æ¯é¡ºåº
    return a.code.localeCompare(b.code);
    })
    .slice(0, limit);
}

// ğŸŒ æŒ‰å›½å®¶ä»£ç æœç´¢
function searchByCountryCode(query: string, limit: number): AirportSearchResult[] | null {
  const countryInfo = getCountryInfoByCode(query.toUpperCase());
  if (countryInfo) {
    return findAirportsByCountry(countryInfo.chineseName, limit);
  }
  return null;
}

/**
 * è·å–æŒ‡å®šå›½å®¶çš„æœºåœºæ•°é‡
 */
export function getAirportCountByCountry(country: string): number {
  return Object.values(globalAirports).filter(
    info => info.country.toLowerCase().includes(country.toLowerCase())
  ).length;
}

/**
 * è·å–å›½å®¶æœºåœºè¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
 */
export function getCountryAirportStats(country: string): {
  total: number;
  displayed: number;
  isLimited: boolean;
  recommendedDisplay: number;
} {
  const totalCount = getAirportCountByCountry(country);

  // ç¾å›½ç‰¹æ®Šå¤„ç†ï¼šæ˜¾ç¤º50ä¸ªæœºåœº
  let recommendedDisplay = 15; // é»˜è®¤æ˜¾ç¤º15ä¸ª
  if (country.toLowerCase().includes('ç¾å›½') || country.toLowerCase().includes('usa') ||
      country.toLowerCase().includes('america') || country.toLowerCase().includes('united states')) {
    recommendedDisplay = 50; // ç¾å›½æ˜¾ç¤º50ä¸ª
  } else if (totalCount > 100) {
    recommendedDisplay = 25; // å…¶ä»–å¤§å›½æ˜¾ç¤º25ä¸ª
  } else if (totalCount > 50) {
    recommendedDisplay = 20; // ä¸­ç­‰å›½å®¶æ˜¾ç¤º20ä¸ª
  } else if (totalCount > 20) {
    recommendedDisplay = 15; // å°å›½æ˜¾ç¤º15ä¸ª
  } else {
    recommendedDisplay = totalCount; // æœºåœºå¾ˆå°‘çš„å›½å®¶æ˜¾ç¤ºå…¨éƒ¨
  }

  const displayed = Math.min(recommendedDisplay, totalCount);
  const isLimited = displayed < totalCount;

  return {
    total: totalCount,
    displayed,
    isLimited,
    recommendedDisplay
  };
}

/**
 * è·å–æ‰€æœ‰å›½å®¶åˆ—è¡¨
 */
export function getAllCountries(): string[] {
  const countries = new Set<string>();
  Object.values(globalAirports).forEach(info => {
    countries.add(info.country);
  });
  return Array.from(countries).sort();
}

/**
 * è·å–æŒ‡å®šæ´²é™…çš„æ‰€æœ‰æœºåœº
 */
export function getAirportsByContinent(continent: string): AirportSearchResult[] {
  let airportData: { [key: string]: AirportInfo } = {};

  switch (continent) {
    case 'å¤§æ´‹æ´²':
      airportData = oceaniaAirports;
      break;
    case 'äºšæ´²':
      airportData = asiaAirports;
      break;
    case 'åŒ—ç¾':
      airportData = northAmericaAirports;
      break;
    case 'å—ç¾':
      airportData = southAmericaAirports;
      break;
    case 'æ¬§æ´²':
      airportData = europeAirports;
      break;
    case 'éæ´²':
      airportData = africaAirports;
      break;
    default:
      return [];
  }

  return Object.entries(airportData).map(([code, info]) =>
    formatAirportResult(code, info)
  ).sort((a, b) => a.code.localeCompare(b.code));
}

/**
 * è·å–ç»Ÿè®¡ä¿¡æ¯ï¼ˆåŒ…æ‹¬å›½é™…æœºåœºç²¾ç¡®æ•°é‡å’ŒæŒ‰æ´²é™…åˆ†ç»„çš„å›½é™…æœºåœºç»Ÿè®¡ï¼‰
 */
export function getAirportStatistics() {
  // åŠ¨æ€ç»Ÿè®¡å„æ´²é™…æœºåœºæ•°é‡
  const continentCounts: { [key: string]: number } = {};
  const continentInternationalCounts: { [key: string]: number } = {};
  let internationalAirportsCount = 0;

  Object.entries(globalAirports).forEach(([code, info]) => {
    const continent = getAirportContinent(code);
    continentCounts[continent] = (continentCounts[continent] || 0) + 1;

    // ç»Ÿè®¡å›½é™…æœºåœºæ•°é‡
    if (info.type === 'international') {
      internationalAirportsCount++;
      continentInternationalCounts[continent] = (continentInternationalCounts[continent] || 0) + 1;
    }
  });

  const stats = {
    total: Object.keys(globalAirports).length,
    international: internationalAirportsCount,
    byContinent: continentCounts,
    internationalByContinent: continentInternationalCounts,
    countries: getAllCountries().length
  };

  return stats;
}
